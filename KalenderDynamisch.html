<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dynamischer Kalender (responsiv, druckbar)</title>

  <!-- =========================
       Basis-Design (Farben/Typo)
       ========================= -->
  <style>
    :root{
      /* Farb-Variablen anpassbar (z.B. Corporate Design) */
      --brand-blue: #2A6099;   /* Header/Schwerpunkt */
      --brand-blue-200: #e6effa;
      --accent-red: #C9211E;   /* besondere Tage/Feiertage */
      --weekend-bg: #f7f2f2;
      --weekday-bg: #ffffff;
      --grid-gap: 12px;
      --radius: 10px;
      --text: #1b1f23;
      --muted: #6b7280;
    }

    * { box-sizing: border-box; }
    body{
      font-family: system-ui, Segoe UI, Roboto, Calibri, sans-serif;
      color: var(--text);
      margin: 16px;
      background: #f4f6f8;
    }

    header{
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 16px;
    }
    header img{ width: 56px; height: 56px; object-fit: contain; }
    header h1{ font-size: 1.4rem; margin: 0; color: var(--brand-blue); }
    header p{ margin: 0; color: var(--muted); }

    /* Toolbar / Filter */
    .toolbar{
      display: grid; grid-template-columns: 1fr auto auto; gap: 8px;
      align-items: center; margin: 8px 0 16px;
    }
    .toolbar .range{
      display: flex; gap: 8px; align-items: center; flex-wrap: wrap;
      font-size: .95rem;
    }
    .toolbar input[type="month"]{
      padding: 8px; border: 1px solid #d1d5db; border-radius: 8px; background: #fff;
    }
    .toolbar button{
      padding: 8px 12px; border: none; border-radius: 10px; cursor: pointer;
      background: var(--brand-blue); color: #fff; font-weight: 600;
    }
    .toolbar button.secondary{ background: #0F4391; opacity:.9 }
    .toolbar .legend{
      justify-self: end; display:flex; gap:12px; align-items:center; flex-wrap: wrap;
      font-size: .9rem; color: var(--muted);
    }
    .dot{ width: 12px; height: 12px; border-radius: 999px; display:inline-block; vertical-align: middle; margin-right:6px; }
    .dot.weekend{ background: var(--weekend-bg); border:1px solid #eee; }
    .dot.holiday{ background: var(--accent-red); }

    /* Monats-Container (responsive Cards) */
    .months{
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: var(--grid-gap);
    }
    .month{
      background: #fff; border-radius: var(--radius);
      box-shadow: 0 2px 10px rgba(0,0,0,.06);
      overflow: hidden; display: flex; flex-direction: column;
    }
    .month-header{
      background: var(--brand-blue);
      color: #fff; padding: 10px 12px;
      display: flex; align-items: center; justify-content: space-between;
      font-weight: 700;
    }
    .month-header small{ opacity: .9; font-weight: 500; }

    /* Wochentags-Kopf (Mo-So) */
    .weekday-row{
      display: grid; grid-template-columns: repeat(7, 1fr);
      gap: 1px; background: #e5e7eb;
    }
    .weekday-row span{
      background: var(--brand-blue-200);
      padding: 6px 4px; text-align: center; font-size: .85rem; font-weight: 600; color: #11365f;
    }

    /* Kalendertage */
    .grid{
      display: grid; grid-template-columns: repeat(7, 1fr);
      gap: 1px; background: #e5e7eb; padding-bottom: 1px;
    }
    .cell{
      background: var(--weekday-bg);
      min-height: 64px; padding: 6px;
      display: flex; align-items: flex-start; justify-content: flex-end;
      position: relative;
    }
    .cell .day{
      font-weight: 700; color: #111827;
      font-size: .95rem;
    }
    .cell.weekend{ background: var(--weekend-bg); }
    .cell.holiday{
      background: #ffecec;
      outline: 2px solid var(--accent-red);
      outline-offset: -2px;
    }
    .cell .label{
      position: absolute; left: 6px; bottom: 6px; right: 6px;
      font-size: .75rem; color: var(--accent-red); font-weight: 600;
      line-height: 1.15;
    }

    /* Druck-Optimierung (A4, Rand, Farben) */
    @media print {
      body { background: #fff; margin: 0; }
      header, .toolbar { display: none; }
      .months { gap: 8px; grid-template-columns: repeat(3, 1fr); }
      .month { box-shadow: none; border: 1px solid #ddd; break-inside: avoid; }
      .cell { min-height: 52px; }
    }
  </style>
</head>
<body>
  <!-- =========================
       Kopf mit Logo/Titel
       ========================= -->
  <header aria-label="Kalender Kopfbereich">
    <!-- Dein SharePoint-Logo oder Abteilungslogo -->
    <img src="logo.png" alt="Abteilungslogo" />
    <div>
      <h1>Kalender – dynamisch (responsive & druckbar)</h1>
      <p>Zeitraum und Feiertage sind konfigurierbar. Wochenenden und Feiertage werden farblich hervorgehoben.</p>
    </div>
  </header>

  <!-- =========================
       Steuerleiste (Zeitraum)
       ========================= -->
  <section class="toolbar" aria-label="Filter und Aktionen">
    <div class="range">
      <label for="start">Startmonat:</label>
      <input id="start" type="month" value="2024-12" />
      <label for="end">Endmonat:</label>
      <input id="end" type="month" value="2026-01" />
    </div>
    <button id="build">Kalender erzeugen</button>
    <div class="legend" aria-label="Legende">
      <span><span class="dot weekend"></span>Wochenende</span>
      <span><span class="dot holiday"></span>Feiertag</span>
      <button class="secondary" onclick="window.print()">Drucken</button>
    </div>
  </section>

  <!-- =========================
       Ausgabebereich
       ========================= -->
  <main class="months" id="months" aria-live="polite"></main>

  <!-- =========================
       Logik: Generierung & Markierungen
       ========================= -->
  <script>
    // ------- Konfiguration: Feiertage (Beispiele DE, bundesweit) -------
    // Format: 'YYYY-MM-DD': 'Bezeichnung'
    const HOLIDAYS = {
      '2025-01-01': 'Neujahr',
      '2025-04-18': 'Karfreitag',
      '2025-04-21': 'Ostermontag',
      '2025-05-01': 'Tag der Arbeit',
      '2025-05-29': 'Christi Himmelfahrt',
      '2025-06-09': 'Pfingstmontag',
      '2025-12-25': '1. Weihnachtstag',
      '2025-12-26': '2. Weihnachtstag',
      '2026-01-01': 'Neujahr'
      // Füge bei Bedarf länderspezifische Feiertage hinzu
    };

    // ------- Hilfsfunktionen -------
    const pad = n => String(n).padStart(2, '0');
    const fmt = (y, m, d) => `${y}-${pad(m)}-${pad(d)}`;

    // Erzeuge Array aller Monate zwischen Start (inkl.) und Ende (inkl.)
    function monthsBetween(startYM, endYM){
      const [ys, ms] = startYM.split('-').map(Number);
      const [ye, me] = endYM.split('-').map(Number);
      const list = [];
      let y = ys, m = ms;
      while (y < ye || (y === ye && m <= me)) {
        list.push({ y, m });
        m++; if (m > 12) { m = 1; y++; }
      }
      return list;
    }

    // Wochentagskürzel (de-DE, Montag zuerst)
    const WEEKDAYS = ['Mo','Di','Mi','Do','Fr','Sa','So'];

    // Baue einen Monats-Block (Card)
    function buildMonth(year, month){
      const first = new Date(year, month - 1, 1);
      const last  = new Date(year, month, 0);
      // JS: getDay() => So=0 ... Sa=6; wir möchten Mo=1 ... So=7
      const firstWeekday = (first.getDay() || 7); // So(0) -> 7
      const daysInMonth  = last.getDate();

      // Header
      const monthName = first.toLocaleDateString('de-DE', { month: 'long' });

      // Container
      const wrap = document.createElement('section');
      wrap.className = 'month';
      wrap.setAttribute('role','group');
      wrap.setAttribute('aria-label', `${monthName} ${year}`);

      // Header HTML
      wrap.innerHTML = `
        <div class="month-header">
          <span>${monthName.charAt(0).toUpperCase() + monthName.slice(1)}</span>
          <small>${year}</small>
        </div>
        <div class="weekday-row">
          ${WEEKDAYS.map(d => `<span>${d}</span>`).join('')}
        </div>
        <div class="grid"></div>
      `;

      const grid = wrap.querySelector('.grid');

      // Leere Zellen vor dem 1. Tag (falls der Monat nicht am Montag beginnt)
      for(let i=1; i<firstWeekday; i++){
        const empty = document.createElement('div');
        empty.className = 'cell';
        empty.setAttribute('aria-hidden','true');
        grid.appendChild(empty);
      }

      // Füllt die Tage
      for (let d=1; d<=daysInMonth; d++){
        const date = new Date(year, month - 1, d);
        const wday = date.getDay(); // 0..6 (So..Sa)
        const iso  = fmt(year, month, d);
        const isWeekend = (wday === 0) || (wday === 6); // So/Sa
        const isHoliday = Object.prototype.hasOwnProperty.call(HOLIDAYS, iso);

        const cell = document.createElement('div');
        cell.className = 'cell' + (isWeekend ? ' weekend' : '') + (isHoliday ? ' holiday' : '');
        cell.setAttribute('data-date', iso);

        cell.innerHTML = `
          <span class="day">${d}</span>
          ${isHoliday ? `<div class="label" title="${HOLIDAYS[iso]}">${HOLIDAYS[iso]}</div>` : ''}
        `;
        grid.appendChild(cell);
      }

      return wrap;
    }

    // Rendert den Kalender in den Container
    function render(){
      const start = document.getElementById('start').value || '2024-12';
      const end   = document.getElementById('end').value   || '2026-01';
      const mount = document.getElementById('months');
      mount.innerHTML = ''; // reset

      const list = monthsBetween(start, end);
      list.forEach(({y,m}) => mount.appendChild(buildMonth(y,m)));
    }

    // Initialrender & Button
    document.getElementById('build').addEventListener('click', render);
    render();
  </script>
</body>
</html>
